"use strict";const input=document.querySelector(".js-input"),button=document.querySelector(".js-button"),resultsList=document.querySelector(".js-results"),favouritesList=document.querySelector(".js-favourites");let series=[],favourites=[];function getResults(){let e=input.value;fetch("//api.tvmaze.com/search/shows?q="+e).then(e=>e.json()).then(e=>{series=e,paintResults(),listenAddItems(),paintFavourites()})}function paintResults(){let e="";for(let t=0;t<series.length;t++){const s=series[t],i=s.show.image?""+s.show.image.medium:"https://via.placeholder.com/210x295/ffffff/666666/?text=TV";e+=`<li class="list__results-item" id="${s.show.id}">`,e+='<div class="list__results-container">',e+=`<img class="list__results-img" src="${i}" alt="${s.show.name}">`,e+=`<h2 class="list__results-title">${s.show.name}</h2>`,e+="</div>",e+="</li>"}if(resultsList.innerHTML=e,0===series.length){document.querySelector(".js-results-container").classList.add("results-container-hidden")}else{document.querySelector(".js-results-container").classList.remove("results-container-hidden")}}const listenAddItems=()=>{const e=document.querySelectorAll(".list__results-item");for(const t of e)t.addEventListener("click",addFavoriteItem)};function addFavoriteItem(e){e.currentTarget;const t=e.currentTarget.id,s=series.find(e=>e.show.id===parseInt(t)),i=favourites.findIndex(e=>e.show.id===parseInt(t));-1===i?(favourites.push(s),paintFavourites(),setInLocalStorage()):(favourites.splice(i,1),paintFavourites(),setInLocalStorage())}function paintFavourites(){let e="";const t=document.querySelector(".js-reset-btn");for(let t=0;t<favourites.length;t++){const s=favourites[t],i=s.show.image?""+s.show.image.medium:"https://via.placeholder.com/210x295/ffffff/666666/?text=TV";e+=`<li class="favourites__list-item" id="${s.show.id}">`,e+='<div class="favourites__list-container">',e+=`<img class="favourites__list-img" src="${i}" alt="${s.show.name}">`,e+=`<h2 class="favourites__list-title">${s.show.name}</h2>`,e+="</div>",e+="</li>"}favouritesList.innerHTML=e,0===favourites.length?t.classList.add("reset-button-hidden"):t.classList.remove("reset-button-hidden"),listenFavouriteItems()}const listenFavouriteItems=()=>{const e=document.querySelectorAll(".favourites__list-item"),t=document.querySelector(".js-reset-btn");for(const t of e)t.addEventListener("click",removeFavouriteItem);t.addEventListener("click",removeAllFavorites)};function removeAllFavorites(){favourites=[],localStorage.removeItem("favourites"),favouritesList.innerHTML="",paintFavourites()}function removeFavouriteItem(e){const t=e.currentTarget.id,s=favourites.findIndex(e=>e.show.id===parseInt(t));favourites.splice(s,1),paintFavourites(),setInLocalStorage()}const getFromLocalStorage=()=>{const e=localStorage.getItem("favourites");null!==e&&(favourites=JSON.parse(e))},setInLocalStorage=()=>{const e=JSON.stringify(favourites);localStorage.setItem("favourites",e)};button.addEventListener("click",getResults),getFromLocalStorage(),paintResults(),paintFavourites();